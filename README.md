# AbemaTV Metadata Extractor

AbemaTVのアニメ・ドラマページから動画ファイル用のメタ情報（タイトル、話数、あらすじ）を抽出するPythonツールです。

## 機能

- **動的URL対応**: 任意のAbemaTVアニメ/ドラマページURLからメタ情報を抽出
- **YAML出力**: 動画ファイルのメタ情報更新用に構造化されたYAMLファイルを生成
- **柔軟なオプション**: あらすじの取得有無を選択可能
- **モジュール設計**: コア機能とCLIが分離された保守性の高い構造

## インストール

### 必要なソフトウェア

- Python 3.7 以上
- pip

### 依存パッケージのインストール

```bash
pip install -r requirements.txt
```

## 使用方法

### 基本使用法

```bash
python3 abema_extractor.py https://abema.tv/video/title/26-249
```

### オプション

| オプション | 説明 | デフォルト |
|-----------|------|-----------|
| `--output`, `-o` | 出力ファイル名 | `metadata.yaml` |
| `--no-synopsis` | あらすじを取得しない（高速） | False |

### 使用例

```bash
# 基本使用法
python3 abema_extractor.py https://abema.tv/video/title/26-249

# 出力ファイル指定
python3 abema_extractor.py https://abema.tv/video/title/189-85 -o marie_metadata.yaml

# 高速モード（あらすじなし）
python3 abema_extractor.py https://abema.tv/video/title/26-249 --no-synopsis

# ヘルプ表示
python3 abema_extractor.py --help
```

## 出力形式

```yaml
series_title: 瑠璃の宝石
source_url: https://abema.tv/video/title/26-249
extraction_date: '2024-02-20'
total_episodes: 13
episodes:
- episode_number: 1
  title: はじめての鉱物採集
  synopsis: 瑠璃の宝石 - 第1話 はじめての鉱物採集 - ...
- episode_number: 2
  title: 宝石の役割
  synopsis: 瑠璃の宝石 - 第2話 宝石の役割 - ...
```

## モジュール構造

```
abema_metadata/
├── __init__.py       # パッケージ初期化
├── models.py         # データモデル
├── extractor.py      # コア抽出機能
└── cli.py            # CLIインターフェース
```

## 開発

### テスト

```bash
# テスト実行
python -m pytest tests/

# 特定のテスト
python -m pytest tests/test_extractor.py::test_extractor_initialization
```

### 拡張

- 新しい出力形式（JSON, CSV）の追加
- 並列処理による高速化
- エラーハンドリングの強化

## ライセンス

MIT License

## 作者

Generated by Mistral Vibe